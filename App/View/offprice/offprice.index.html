<? require(ViewDir.'/header.html'); ?>

<link rel="stylesheet" href="<?=StaticDir?>1.2/css/import-comm.css"/>
<link rel="stylesheet" href="<?=StaticDir?>1.2/css/list.css"/>
<link rel="stylesheet" href="<?=StaticDir?>1.2/css/ms-filter.css"/>

<div class="w1180 ms-filterWrapper f-clearfix">
    <!-- ms-filterMain start -->
    <div class="ms-filterMain">
        <!-- ms-filters start -->
        <div class="ms-filters">
            <div class="ms-filterResults">
                <span>全部结果&nbsp;&gt;</span>
                <ul class="ms-filterResultsList f-clearfix">
                    <? if ( $c ) { ?>
                        <li title="<?=$c_title?>"><a href="javascript:void(0);" onclick="createUrl('_class', '');"><?=mb_substr($c_title,0,12,'utf-8')?><i class="us-icon us-icon23"></i></a></li>
                    <? } ?>
                    <? if ( $g ) { ?>
                        <li title="<?=$g_title?>"><a href="javascript:void(0);" onclick="createUrl('_group', '');"><?=mb_substr($g_title,0,12,'utf-8')?><i class="us-icon us-icon23"></i></a></li>
                    <? } ?>
                </ul>
            </div>
            <div class="ms-condition">
                <? if ( empty($c) ) {?>
                <div class="ms-conditionList">
                    <span>商标分类</span>
                    <div class="ms-conditionList-main">
                        <ul class="f-clearfix ms-conditionRadio">
                            <li><a href="" onclick="createUrl('_class','0');return false;">全部</a></li>
                        <?foreach ($_CLASS as $_cls => $_cn) {?>
                            <li><a href="javacript:void(0);" onclick="createUrl('_class','<?=$_cls?>');return false;"><?=$_cls?>-<?=$_cn?></a></li>
                        <?}?>
                        </ul>
                        <ul class="f-clearfix ms-conditionCheckbox">
                        <?foreach ($_CLASS as $_cls => $_cn) {?>
                            <li><input type="checkbox" value="<?=$_cls?>" id="class-checkbox<?=$_cls?>" name="class-checkbox<?=$_cls?>"/>
                            <label for="class-checkbox<?=$_cls?>" onclick=""><?=$_cls?>-<?=$_cn?></label></li>
                        <?}?>
                        </ul>
                        <div class="ms-condition-btn">
                            <a href="javascript:void(0);" tname="_class">确定</a>
                            <span onclick="cancelFun(this);">取消</span>
                        </div>
                        <div class="ms-conditionBtn">
                            <span class="ms-multi" onclick="multi(this);">多选</span>
                        </div>
                    </div>
                </div>
                <? } ?>
                <? if ( empty($g) && !empty($c) && count(explode(',', $c)) == 1 ) {?>
                <div class="ms-conditionList">
                    <span>分类群组</span>
                    <div class="ms-conditionList-main">
                        <ul class="f-clearfix ms-conditionRadio">
                            <li><a href="javacript:void(0);" onclick="createUrl('_group','0');return false;">全部</a></li>
                        <?foreach ($_GROUP[$c] as $_grp => $_gn) {?>
                            <li title="<?=$_gn?>"><a href="" onclick="createUrl('_group','<?=$_grp?>');return false;"><?=$_grp?>-<?=mb_substr($_gn, 0, 8, 'UTF-8')?></a></li>
                        <?}?>
                        </ul>
                        <ul class="f-clearfix ms-conditionCheckbox">
                        <?foreach ($_GROUP[$c] as $_grp => $_gn) {?>
                            <li title="<?=$_gn?>"><input type="checkbox" id="group-checkbox<?=$_grp?>" value="<?=$_grp?>" />
                            <label for="group-checkbox<?=$_grp?>"><?=$_grp?>-<?=mb_substr($_gn, 0, 8, 'UTF-8')?></label></li>
                        <?}?>
                        </ul>
                        <div class="ms-condition-btn">
                            <a href="javascript:void(0);" tname="_group">确定</a>
                            <span onclick="cancelFun(this);">取消</span>
                        </div>
                        <div class="ms-conditionBtn">
                            <span class="ms-multi" onclick="multi(this);">多选</span>
                        </div>
                    </div>
                </div>
                <? } ?>
            </div>
        </div>
        <!-- ms-filters end -->
        <!-- ms-filterSearch start -->
        <div class="ms-filterSearchMain f-clearfix">
            <p>共有<span><?=$total?></span>个商标</p>
        </div>
        <!-- ms-filterSearch end -->
        <!-- ms-filtersList start -->
        <div class="ms-filtersList">
            <ul class="f-clearfix" id="s-all-list">
    <?if ( !empty($searchList) ){?>
        <? foreach ($searchList as $k => $v) {?>
            <? $_c_ = explode(',', $v['class']);
            if ( count($_c_) < 2 ) {
            ?>
                <li>
                    <div>
                        <div class="ms-filterCenter">
                            <a href="<?=$v['viewUrl']?>" class="ms-collect cur"><i class="us-icon us-icon20"></i></a>
                            <span class="ms-filtersImg"><a href="<?=$v['viewUrl']?>"><img src="<?=$v['imgUrl']?>" alt=""/></a></span>
                            <div class="ms-filtersListTxt">
                                <h6><?=$v['name']?></h6>
                                <p><?=$v['class']?></p>
                                <p title="<?=$v['group']?>"><?=mb_substr($v['group'], 0, 8, 'UTF-8')?mb_substr($v['group'], 0, 8, 'UTF-8'):'-'?></p>
                            </div>
                            <div class="ms-filterBtn">
                                <a href="#" class="ms-inquiry">&yen;&nbsp;询&nbsp;价</a>
                                <a href="#" class="ms-seller"><i class="us-icon us-icon22"></i>联系卖家</a>
                            </div>
                        </div>
                    </div>
                </li>
            <? }else{ ?>
                <li>
                    <div class="ms-filterMany">
                        <div class="ms-filterCenter">
                            <a href="<?=$v['viewUrl']?>" class="ms-collect"><i class="us-icon us-icon20"></i></a>
                            <span class="ms-filtersImg"><a href="<?=$v['viewUrl']?>"><img src="<?=StaticDir?>1.2/images/brand-lg.png" alt=""/></a></span>
                            <div class="ms-filtersListTxt">
                                <h6><?=$v['name']?></h6>
                                <p>共<em><?=count($_c_)?></em>个分类</p>
                                <p title="<?=$v['group']?>"><?=mb_substr($v['group'], 0, 8, 'UTF-8')?mb_substr($v['group'], 0, 8, 'UTF-8'):'-'?></p>
                            </div>
                            <div class="ms-filterBtn">
                                <a href="#" class="ms-inquiry">&yen;&nbsp;询&nbsp;价</a>
                                <a href="#" class="ms-seller"><i class="us-icon us-icon22"></i>联系卖家</a>
                            </div>
                        </div>
                        <div class="ms-sortMain">
                            <ul class="ms-sortList">
                            <?foreach ($_c_ as $_k => $_v) {
                                if ( $_k > 10 ) break;
                            ?>
                                <li><span><?=$_v?>类</span>-<?=$_CLASS[$_v]?></li>
                            <?}?>
                            </ul>
                            <div class="ms-sortMore">
                                <a href="<?=$v['viewUrl']?>">查看更多&nbsp;&gt;</a>
                            </div>
                        </div>
                    </div>
                </li>
            <? } ?>
        <? } ?>
    <? }else{ ?>
        <div class="sbhwjg">
            <div class="sbhwjg-main">
                <h3>没找到相关信息</h3>
                <font>
                    建议你：<br>
                    1 . 检查<lable>商标号</lable>，确保输入<lable>正确</lable>。<br>
                    2 . <a>联系我们</a> 让我们帮你找吧！<br>
                    <span><img src="<?=StaticDir?>1.2/images/wjg-ico.png">3秒极速匹配</span> <span><img src="<?=StaticDir?>1.2/images/wjg-ico.png">1对1专业服务</span>
                </font>

            </div>
        </div>
        <div id="tm-uploading" style="padding-top:33px;text-align:center;display:none;height:100px;"><img src="<?=StaticDir?>images/loading.gif"></div>
    <? } ?>
            </ul>
        </div>
        <!-- ms-filtersList end -->

            <div id="s-uploading" style="padding-top:33px;text-align:center;display:none;height:100px;"><img src="<?=StaticDir?>images/loading.gif"></div>
            <button type="button" onclick="changeDD();"></button>
    </div>
    <!-- ms-filterMain end -->
    <!-- ms-recommend start -->
    <dl class="ms-recommend">
        <dt><span>特价商标推荐</span><img src="<?=StaticDir?>1.2/images/xstj.png" alt=""/></dt>
        <dd>
            <span><img src="<?=StaticDir?>1.2/images/catepic1.png" alt=""/></span>
            <div class="ms-filtersListTxt">
                <div>
                    <h6><a href="">梵秀,FAMXIU</a></h6>
                    <p>30类 - 食品佐料</p>
                    <p>群组名称</p>
                </div>
            </div>
        </dd>
        <dd>
            <span><img src="<?=StaticDir?>1.2/images/brand-lg7.png" alt=""/></span>
            <div class="ms-filtersListTxt">
                <div>
                    <h6><a href="">梵秀,FAMXIU</a></h6>
                    <p>30类 - 食品佐料</p>
                    <p>群组名称</p>
                </div>
            </div>
        </dd>
        <dd>
            <span><img src="<?=StaticDir?>1.2/images/brand-lg6.png" alt=""/></span>
            <div class="ms-filtersListTxt">
                <div>
                    <h6><a href="">梵秀,FAMXIU</a></h6>
                    <p>30类 - 食品佐料</p>
                    <p>群组名称</p>
                </div>
            </div>
        </dd>
        <dd>
            <span><img src="<?=StaticDir?>1.2/images/brand-lg5.png" alt=""/></span>
            <div class="ms-filtersListTxt">
                <div>
                    <h6><a href="">梵秀,FAMXIU</a></h6>
                    <p>30类 - 食品佐料</p>
                    <p>群组名称</p>
                </div>
            </div>
        </dd>
    </dl>
    <!-- ms-recommend end -->
</div>

<div id="_tmpDiv" style="display:none"></div>

<!--浮动客服-->
<div class="fdkf-ss">
   <img src="<?=StaticDir?>1.2/images/fdkf-ss.png">
</div>
<div class="fdkf-zk" style="z-index:100;">

    <ul class="w1180">
        <span class="gb-ss"></span>
        <li class="btm-tel">
            <a>
                <img src="<?=StaticDir?>1.2/images/zx-ico.png">
                在线咨询
            </a>
        </li>
        <li class="btm-pel">
            <img src="<?=StaticDir?>1.2/images/btm-pel.png">
        </li>
        <li class="btm-tj">
            <p><img src="<?=StaticDir?>1.2/images/btm-wz.png"></p>
            <div>
                <select oninvalid="请选择商标所属行业">
                    <option value="请选择商标所属行业">请选择商标所属行业</option>
                    <option value="saab">Saab</option>
                    <option value="opel">Opel</option>
                    <option value="audi">Audi</option>
                </select>
                <input type="tel" placeholder="请输入手机号"/>
                <a>免费推荐</a>
            </div>
        </li>
    </ul>
</div>
<script type="text/javascript">
    $(".fdkf-ss").click(function(){
        $(this).hide();
        $(".fdkf-zk").show();
        $(".fdkf-zk").animate({width:"100%"});;
    })
    $(".gb-ss").click(function(){
        $(".fdkf-zk").hide();
        $(".fdkf-zk").animate({width:"0"});;
        $(".fdkf-ss").show();
    })
</script>
<script src="<?=StaticDir?>1.2/js/jquery-1.8.3.min.js"></script>
<script src="<?=StaticDir?>script/objurl.js"></script>

<script>

    //初始化更多
    var minHeight = 40; //最小高度
    var conditionDom = $('.ms-condition');
    var conditionList = conditionDom.find('.ms-conditionList-main');
    var setHeight = 'ms-setHeight';
    var curCls = 'cur';
    function initMore(isTure){
        conditionList.each(function(){
            var $this = $(this);
            var conditionMore = '';
            var conditionBtn = $this.find('.ms-conditionBtn');
            var conditionListHeight = $this.innerHeight();
            if(conditionListHeight > minHeight){
                $this.addClass(setHeight);
                isTure ? conditionMore = '<span class="ms-conditionMore" onclick="moreFun(this);">更多</span>' : true;
            }
            conditionBtn.append(conditionMore);
        });
    }
    initMore(true);

    //多选
    function multi(dom){
        var $this = $(dom);
        var moreDom = $this.next();
        var parent = $this.parent().parent();
        parent.removeClass(setHeight).addClass(curCls);
        resetFun(parent);
        if(moreDom.hasClass('ms-conditionMore')){
            moreDom.addClass(curCls).text('收起');
        }
    }

    //取消多选
    function cancelFun(dom){
        var $this = $(dom);
        var parent = $this.parent().parent();
        var moreDom = parent.find('.ms-conditionMore');
        parent.removeClass(curCls);
        moreDom.removeClass(curCls).text('更多');
        initMore(false);
    }

    //更多
    function moreFun(dom){
        var $this = $(dom);
        var parent = $this.parent().parent();
        resetFun(parent);
        initMore(false);
        if(!$this.hasClass(curCls)){
            parent.removeClass(setHeight);
            $this.addClass(curCls).text('收起');
        }else{
            parent.addClass(setHeight);
            $this.removeClass(curCls).text('更多');
        }
    }
    //重置
    function resetFun(dom){
        dom.parent().siblings().find('.ms-conditionList-main').removeClass(curCls)
                .find('.ms-conditionMore').removeClass(curCls).text('更多');
    }

    var _start      = 1;
    var _whereStr   = "<?=$whereStr?>";
    var _moreUrl    = '/<?=$_mod_?>/getMore/';
    var _url        = '/<?=$_mod_?>/index/?';
    var _urlSearch  = '/<?=$_mod_?>/index/?';
    var _hasSale    = "<?=$has?>";
    var _times      = 0;
    var _objTime ;
    var _mod        = "<?=$_mod_?>";
    var _buttomView = false;
    var _maodian    = "#searchC";

    //处理URL
    function createUrl(parameter,value){

        var obj = new objURL('/?'+_whereStr);
        switch(parameter){
            case "_class" :
                obj.set('c', value);
                if ( value == '' || value == 0 ) obj.set('g', '');
                break;
            case "_group" :
                obj.set('g', value);
                break;
        }        
        var params = obj.strparams();
        var allurl = _url+params;
        window.location.href = allurl;
    }

    $(".ms-condition-btn a").click(function(){
        var inputDom = $(this).parent().prev().find(':checked');
        var str = '';
        inputDom.each(function(){
            str += ","+$(this).val();
        })
        str = str ? str.substr(1) : '';
        //alert(str);
        if ( str ){
            var tname = $(this).attr('tname');
            createUrl(tname, str);
        }
    });


    //加载剩余数据
    function loadMore(){
        //出售与商标库都没有了
        if ( !_hasSale ) return false;

        $('#s-uploading').show();
        //是否已经在请求中
        if ( _times != 0 ) return false; 

        var obj = new objURL('/?'+_whereStr);

        _start++;
        _times      = 1;
        _objTime    = setTimeout(function(){_times = 0;},30000);

        obj.set('_p', _start);
        var params = obj.getparams();
        $("#_tmpDiv").load(_moreUrl, params, function(data,status,xml){
            if (data) {
                $("#s-all-list").append(data);
                $("#_tmpDiv").html('');
                $('#s-uploading').hide();
                clearTimeout(_objTime);
                _times = 0;
            }else{
                _hasSale = false;
                $('#s-uploading').hide();
                _times = 1;
            }
        });
    }

    $(window).scroll(function () {
        var scrollTop = $(this).scrollTop();
        var scrollHeight = $(document).height();
        var windowHeight = $(this).height();
        if (scrollHeight - scrollTop - windowHeight < 670)  {
            loadMore();
        }
    });

    $(".mj-dd").remove();
</script>

<? require(ViewDir.'/footer.html'); ?>