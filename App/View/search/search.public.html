
<script type="text/javascript" src="<?=StaticDir?>script/objurl.js"></script>

<div class="mj-banner"></div>
<!--content start-->

<div class="mj-content">
    <div class="w1180">
        <!--search start-->
        <dl class="mj-selection">
        <? if ($kw){ ?>
            <dd class="f-clearfix">
                <span>查询条件：<?=$kw?></span>
            </dd>
        <? }?>
            <dd class="f-clearfix">
                <span class="mj-selection-span">商标类别：</span>
                <div class="mj-selection-list" id="j-dltype">
                    <a href="javascript:getClass(0);"  <?if ($c == 0){echo 'class="current"';}?>>全部  </a>
                <? foreach ($CLASSES as $key => $value) { ?>
                    <a href="javascript:getClass(<?=$key?>);" <?if ($c == $key){echo 'class="current"';}?>><?echo $key.'类-'.$value?></a>
                <? } ?>
                    <a href="javascript:;" class="curs" id="mj_aclik">......</a>
                </div>
            </dd>
        <? if( !empty($groupList) ){ ?>
            <dd class="f-clearfix">
                <span class="mj-selection-span">所属群组：</span>
                <div class="mj-selection-list" id="g-dltype">
                    <a href="javascript:getGroup(0);" <?if ($g == 0){echo 'class="current"';}?>>全部  </a>
                <? foreach ($groupList as $ky => $val) { ?>
                    <a href="javascript:getGroup('<?=$ky?>');" <?if ($g == $ky){echo 'class="current"';}?> title="<?=$val?>">
                    <?=mb_substr($val, 0, 7, 'utf8')?></a>
                <? } ?>
                <? if ( count($groupList) > 7 ){?>
                    <a href="javascript:;" class="curs" id="mg_aclik">......</a>
                <?}?>
                </div>
            </dd>
        <? } ?>
            <dd class="f-clearfix">
                <span class="mj-selection-span">平台入驻： </span>
                <div class="mj-selection-list">
                    <a href="javascript:getPlatform(0);" <?if ($p == 0){echo 'class="current"';}?>>全部  </a>
                <? foreach ($PLATFORM as $k => $v) { ?>
                    <a href="javascript:getPlatform(<?=$k?>);" <?if ($p == $k){echo 'class="current"';}?>><?=$v?></a>
                <? } ?>
                </div>
            </dd>
        </dl>
        <!--search end-->
        <!--imglist start-->
        <div class="w1180">
            <ul class="mj_goods_check f-clearfix">
                <li><input type="checkbox" id="chek1"><label for="chek1">中文</label></li>
                <li><input type="checkbox" id="chek2"><label for="chek2">英文</label></li>
                <li><input type="checkbox" id="chek3"><label for="chek3">图形</label></li>
                <li><input type="checkbox" id="chek4"><label for="chek4">中+英</label></li>
                <li><input type="checkbox" id="chek5"><label for="chek5">中+图</label></li>
                <li><input type="checkbox" id="chek6"><label for="chek6">英+图</label></li>
                <li><input type="checkbox" id="chek7"><label for="chek7">中+英+图</label></li>
                <li><input type="checkbox" id="chek8"><label for="chek8">3个字</label></li>
            </ul>
            <div class="mj-imglists">
                <ul class="f-clearfix" id="s-all-list">
                <? foreach ($searchList as $k => $v) { ?>
                    <li>
                        <p class="mj-tip">
                            <?if ($v['isOffprice'] == true){?><label class="mj-tThe" title="特价产品">特</label><?}?>
                            <?if ($v['isBest'] == true){?><label class="mj-tJing" title="精品推荐">精</label><?}?>
                            <?if ($v['isLicence'] == true){?><label class="mj-tShow" title="授权租用">授</label><?}?>
                        </p>
                        <div class="mj-imglT">
                            <a href="/trademark/view/?tid=<?=$v['tid']?>&class=<?=$v['class']?>" target="_blank" class="mj-imglT"><span><img src="<?=$v['imgUrl']?>" onerror="this.src='<?=StaticDir?>images/img1.png'" title="<?=$v['name']?>"></span></a>
                        </div>
                        <div class="mj-imglB">
                            <span>(<?=$v['class']?>类)</span>
                            <p title="<?=$v['name']?>"><?=mb_substr($v['name'],0,10,'utf8')?>&nbsp;&nbsp;<?=$CLASSES[$v['class']]?></p>
                        </div>
                    </li>
                <? } ?>
                </ul>
            </div>

            <div id="s-nothing" style="text-align:center;display:none;">后面没有数据了。。。</div>
            <div id="s-uploading" style="padding-top:200px;text-align:center;display:none;height:300px;"><img src="<?=StaticDir?>images/loading.gif"></div>
        </div>
        <!--imglist end-->
    </div>
</div>

<!--content end-->
<div class="mj-mainbg">
    <div class="mj-footerTip">
        <div class="w1180">
            <div class="mj-bgimg">
                <img src="<?=StaticDir?>style/img/mj-img7.png" alt=""/>
                <a href=""><span>后面还有 <strong> 3000 </strong>商标可购买，实在太多 --  提交购买需求我们帮你匹配？</span></a>
                <!--<label>往下滚动自动消失</label>-->
            </div>
        </div>
    </div>
</div>

<div id="_tmpDiv" style="display:none"></div>

<script type="text/javascript">
    var _number     = <?=$_number?>;
    var _start      = 0;
    var _whereStr   = "<?=$whereStr?>";
    var _moreUrl    = '/<?=$_mod_?>/getMore/';
    var _url        = '/<?=$_mod_?>/index/?';
    var _has        = true;
    var _class      = "<?=$c?>";
    var _group      = "<?=$g?>";

    function getClass(cls)
    {
        var obj = new objURL('/?'+_whereStr);
        obj.set('c', cls==0?'':cls);
        obj.set('g', '');
        obj.set('p', '');
        var params = obj.strparams();
        window.location = _url+params;
    }

    function getGroup(grp)
    {
        var obj = new objURL('/?'+_whereStr);
        obj.set('c', _class==0?'':_class);
        obj.set('g', grp==0?'':grp);
        obj.set('p', '');
        var params = obj.strparams();
        window.location = _url+params;
    }

    function getPlatform(plat)
    {
        var obj = new objURL('/?'+_whereStr);
        obj.set('c', _class==0?'':_class);
        obj.set('g', _group==0?'':_group);
        obj.set('p', plat==0?'':plat);
        var params = obj.strparams();
        window.location = _url+params;
    }

    function loadMore(){
        if (!_has) return false;
        $('#s-uploading').show();
        var obj = new objURL('/?'+_whereStr);
        _start += _number;
        obj.set('n', _start);
        var params = obj.getparams();
        $("#_tmpDiv").load(_moreUrl, params, function(data,status,xml){
            if (status != 'success'){
                $('#s-uploading').hide();
                $("#s-nothing").html('请求失败，请稍后再试。');
                $("#s-nothing").show();
                return false;
            }
            if (data) {
                $("#s-all-list").append(data);
                $("#_tmpDiv").html('');
                $('#s-uploading').hide();
            }else{
                _has = false;
                $('#s-uploading').hide();
                $("#s-nothing").html('后面没有数据了。。。');
                $("#s-nothing").show();
            }
        });
    }

    if ( _class >= 7 ){
        var _first = $("#j-dltype").find('a').first();
        $("#j-dltype").prepend($("#j-dltype > .current"));
        $("#j-dltype").prepend(_first);
    }
    
    $("#g-dltype").find('a').each(function (k,v){
        if ( $(this).hasClass('current') ){
            if ( k >= 7 && $("#g-dltype").find('a').length > 8){
                var _first = $("#g-dltype").find('a').first();
                $("#g-dltype").prepend($("#g-dltype > .current"));
                $("#g-dltype").prepend(_first);
            }
        }
    });
    
    $(window).scroll(function () {
        var scrollTop = $(this).scrollTop();
        var scrollHeight = $(document).height();
        var windowHeight = $(this).height();
        if (scrollTop + windowHeight == scrollHeight) {
            loadMore();
        }
    });

</script>